## Script to add proper header to kern files for partjoin
#1. take interpretations from the first of the krn files (xx00) and save in separate file called 'interp.krn'

rid -D xx00 | grep -v '\*-' > interp.krn
sed -i '$a*G:	*G:' interp.krn

#2. remove comments or headers from the first of the kern files, put final 'end file' interpretation back on.

rid -GLId xx00 > stripped
sed -i '$a*-	*-' stripped
mv stripped xx00

#NA. Take the first six lines of each encoding phrase and save in a temporary file: 

#num=1
#for file in *Claire.txt 
#do
#	if [ $num -lt 10 ]
#	then
#		sed -n 1,6p $file | extract -f 1,2 > temp_header0$num 
#	else
#		sed -n 1,6p $file | extract -f 1,2 > temp_header$num 
#	fi
#num=$((num+01))
#done
		
		
#3. Cat each kern phrase (1 at a time) to the end of the interp file 

#arrayx=( temp_header* )

#arrayy=( xx* )

#let i=1
#for file in ${arrayy[@]}; do
#	if [ $i -lt 10 ]
#	then
#		cat $file ${arrayx[$i-1]} > phrase0$i.krn 
#	else
#
#		cat $file ${arrayy[$i-1]} > phrase$i.krn 
#	fi
#let i=$i+1
#done

let i=1
for file in xx*
do
	if [ $i -lt 10 ]
	then
		cat interp.krn $file | grep -v '^$' > phrase0$i.krn
	else
		cat interp.krn $file | grep -v '^$' > phrase$i.krn
	fi
let i=$i+1
done 

#4. change the **chords and **encoding to **kern **kern, get rid of 'measure 0'.

#for file in phrase*.krn
#do
#sed 's/\*\*chords	\*\*function/**kern	**kern/g' $file | grep -v '^=0-' > ready$file  
#done


## all kern phrase files should now have the same headers 
## need to manually go through files and adjust.

#NA. Final "matching" of spines:

#for file in ready*
#do
#sed -i 's:\*M6\/8	\*:*M6/8	*M6/8:g;s/\*G:	\*/*G:	*G:/g' $file 
#done

#rm phrase*
#rm temp_header*
